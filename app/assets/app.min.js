function startGame(e){var t={game:e},n=new XMLHttpRequest,o=convertParam(t),d=base_url+"index/start_game";n.open("POST",d,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=JSON.parse(n.responseText);document.getElementById("id").value=e.id,""!=e.globle_best.score&&(document.getElementById("txt_globle_best").textContent=e.globle_best.score),""!=e.my_best.score&&(document.getElementById("txt_my_best").textContent=e.my_best.score)}else console.log(this.status)},n.onerror=function(){},n.send(o)}function openCard(e){var t=document.getElementById("click").value,n=parseInt(t)+1,o=document.getElementById("check").value,d=new XMLHttpRequest,a=base_url+"index/select_card",m=document.getElementById("txt_game").textContent,s={index:e,click:n,id:document.getElementById("id").value,couple:o,game:m};if(""==document.getElementById("num_"+e).textContent){var c=convertParam(s);d.open("POST",a,!0),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var e=JSON.parse(d.responseText);if(1==o)document.getElementById("num_"+e.data.index).textContent=e.data.number,document.getElementById("box_"+e.data.index).classList.add("open"),document.getElementById("box_"+e.data.index).classList.remove("close");else{if(1==e.data.match?(document.getElementById("num_"+e.data.index).textContent=e.data.number,document.getElementById("box_"+e.data.index).classList.add("open"),document.getElementById("box_"+e.data.index).classList.remove("close")):(disableDoSomething(),document.getElementById("num_"+e.data.index).textContent=e.data.number,document.getElementById("box_"+e.data.index).classList.add("open"),document.getElementById("box_"+e.data.index).classList.remove("close"),setTimeout(function(){document.getElementById("num_"+e.data.index).textContent="",document.getElementById("box_"+e.data.index).classList.add("close"),document.getElementById("box_"+e.data.index).classList.remove("open"),document.getElementById("num_"+e.data.old_index).textContent="",document.getElementById("box_"+e.data.old_index).classList.add("close"),document.getElementById("box_"+e.data.old_index).classList.remove("open"),enableDoSomething()},1500)),1==e.my_best.res){var t=e.my_best.data.score;document.getElementById("txt_my_best").textContent=t}if(1==e.globle.res){var a=e.globle.data.score;document.getElementById("txt_globle_best").textContent=a}}document.getElementById("check").value=e.chk_coup,document.getElementById("click").value=n,document.getElementById("txt_click").textContent=n}},d.send(c)}else console.log("double click card")}var functionHolder;function disableDoSomething(){functionHolder||(functionHolder=window.openCard),window.openCard=function(){}}function enableDoSomething(){window.openCard=functionHolder}function convertParam(e){let t=new URLSearchParams(e);return decodeURIComponent(t.toString()),t.toString()}function newGameClick(){for(var e=document.getElementsByClassName("grid-item"),t=0;t<e.length;t++)e[t].classList.add("close"),e[t].classList.remove("open");for(e=document.getElementsByClassName("txt"),t=0;t<e.length;t++)e[t].textContent="";var n=document.getElementById("txt_game").textContent,o=parseInt(n)+1;document.getElementById("txt_game").textContent=o,newGame(o)}function newGame(e){var t={game:e,id:document.getElementById("id").value},n=new XMLHttpRequest,o=convertParam(t),d=base_url+"index/new_game";n.open("POST",d,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=JSON.parse(n.responseText);""!=e.globle_best.score&&(document.getElementById("txt_globle_best").textContent=e.globle_best.score),""!=e.my_best.score&&(document.getElementById("txt_my_best").textContent=e.my_best.score),document.getElementById("txt_click").textContent="-",document.getElementById("click").value=0,document.getElementById("check").value=1}else console.log(this.status)},n.onerror=function(){},n.send(o)}startGame(document.getElementById("txt_game").textContent);